<!DOCTYPE html>
<html lang="ro">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Rezultatul tƒÉu Nebshome</title>
        <style>
            :root {
                --ink: #111;
                --muted: #67708a;
                --ring: #e7e9f3;
                --brand: #3a7afe;
                --card: #ffffff;
                --bg: #f6f7fb;
            }
            * {
                box-sizing: border-box;
            }
            body {
                margin: 0;
                font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
                background: var(--bg);
                color: var(--ink);
            }
            .shell {
                max-width: 980px;
                margin: 40px auto;
                padding: 0 16px;
            }
            .hero {
                background: linear-gradient(135deg, #fff 0%, #fff 35%, #f7fbff 100%);
                border: 1px solid var(--ring);
                border-radius: 20px;
                padding: 24px 28px;
                box-shadow: 0 6px 24px rgba(0, 0, 0, 0.06);
            }
            .brand {
                display: flex;
                gap: 12px;
                align-items: center;
                margin-bottom: 8px;
                color: var(--muted);
            }
            .brand .dot {
                width: 10px;
                height: 10px;
                border-radius: 50%;
                background: var(--brand);
            }
            .title {
                font-size: clamp(24px, 3vw, 32px);
                line-height: 1.25;
                margin: 0 0 6px;
            }
            .subtitle {
                margin: 0.25rem 0 1.25rem;
                color: var(--muted);
            }
            .badge {
                display: none;
                align-items: center;
                gap: 8px;
                background: #fff;
                border: 1px solid var(--ring);
                border-radius: 14px;
                padding: 6px 10px;
                width: max-content;
            }
            .badge .emoji {
                font-size: 18px;
            }
            .card {
                display: none;
                margin-top: 18px;
                background: #fff;
                border: 1px solid var(--ring);
                border-radius: 12px;
                padding: 18px;
            }
            .grid {
                display: grid;
                gap: 16px;
                grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            }
            .block h6 {
                margin: 0 0 8px;
                color: var(--muted);
                letter-spacing: 0.02em;
                text-transform: uppercase;
                font-size: 12px;
            }
            .block p {
                margin: 0;
                color: #232a3a;
            }
            .ul {
                margin: 0;
                padding-left: 18px;
            }
            .ul li {
                margin: 0.4rem 0;
            }
            .btns {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                margin-top: 12px;
            }
            .btn {
                appearance: none;
                border: 1px solid var(--ring);
                background: #fff;
                color: var(--ink);
                padding: 10px 14px;
                border-radius: 10px;
                font-weight: 600;
                cursor: pointer;
            }
            .btn.primary {
                background: var(--brand);
                border-color: var(--brand);
                color: #fff;
            }
            .note {
                margin-top: 12px;
                color: var(--muted);
                font-size: 14px;
            }

            .center {
                max-width: 700px;
                margin: 0 auto;
            }
            .error {
                padding: 18px;
                border-radius: 14px;
                background: #fff;
                border: 1px solid var(--ring);
                text-align: center;
            }
            .error strong {
                color: #b42318;
            }
            .input {
                width: 100%;
                padding: 12px;
                border: 1px solid #d8dde6;
                border-radius: 8px;
            }
            .btn.submit {
                width: 100%;
                padding: 12px 18px;
                background: #6d6afe;
                border: 1px solid #6d6afe;
                border-radius: 10px;
                color: #fff;
                font-weight: 700;
                margin-top: 10px;
            }
            .msg {
                display: none;
                margin-top: 12px;
                color: var(--muted);
            }
        </style>
    </head>
    <body>
        <main class="shell">
            <section class="hero">
                <div class="brand"><span class="dot"></span><span>Nebshome</span></div>
                <h1 class="title">Rezultatul tƒÉu Nebshome</h1>
                <p class="subtitle">Recomandare personalizatƒÉ pentru stilul tƒÉu de locuire</p>

                <div id="badge" class="badge" style="display: none;">
                    <span class="emoji" id="emoji">üè†</span>
                    <span id="badgeTitle">Profil</span>
                </div>

                <div class="card center" id="card" style="display: none;">
                    <section>
                        <h2 id="head" style="margin: 0 0 12px;"></h2>

                        <div class="grid">
                            <div class="block">
                                <h6>Locuin»õa idealƒÉ</h6>
                                <p id="ideal"></p>
                            </div>
                            <div class="block">
                                <h6>La ce sƒÉ fii atent</h6>
                                <ul id="checks" class="ul"></ul>
                            </div>
                        </div>

                        <div class="block" style="margin-top: 8px;">
                            <h6>Sfat personal</h6>
                            <p id="tip"></p>
                        </div>

                        <div class="btns">
                            <button class="btn" onclick="window.print()">DescarcƒÉ / PrinteazƒÉ</button>
                            <a class="btn" href="/ro/test.html">Reia testul</a>
                        </div>
                        <p class="note">‚ìò AnalizƒÉ generatƒÉ pe baza rƒÉspunsurilor tale.</p>
                    </section>
                </div>

                <!-- BLOCAJ EMAIL (APARE DUPƒÇ PLATƒÇ) -->
                <div id="emailBlock" class="card center" style="display: none; margin-top: 12px;">
                    <h3 style="margin: 0 0 10px;">Prime»ôte rezultatul pe email</h3>
                    <form id="sendForm">
                        <input type="email" id="email" required placeholder="exemplu@email.com" class="input" />
                        <button type="submit" id="sendBtn" class="btn submit">Trimite rezultatul</button>
                    </form>
                    <p id="msg" class="msg"></p>
                </div>

                <!-- FALLBACK -->
                <div id="fallback" class="error" style="display: none; margin-top: 12px;"><strong>Profil indisponibil</strong> ‚Äî te rugƒÉm sƒÉ reiei testul.</div>
            </section>
        </main>

        <script>
            /** 1) Parametri din URL **/
            const qs = new URLSearchParams(location.search);
            const profile = (qs.get("profile") || "").toLowerCase().trim();
            const lang = (qs.get("lang") || "ro").toLowerCase().trim();
            const session = (qs.get("session_id") || "").trim();
            const orderId = (qs.get("order_id") || "").trim();

            /** 2) Emojis per profil (pt. insignƒÉ) **/
            const emojis = {
                explorer: "üß≠",
                family: "üë®‚Äçüë©‚Äçüëß",
                dreamer: "üåø",
                minimal: "‚ú®",
                introvert: "üîï",
                visionary: "üåÖ",
                builder: "üõ†Ô∏è",
            };

            /** 3) Con»õinut premium per profil **/
            const profileData = {
                explorer: {
                    title: "Explorator Urban",
                    lead: "E»ôti atras de energie, noutate »ôi dinamism. Casa ta te sus»õine sƒÉ fii conectat cu ora»ôul, dar √Æ»õi oferƒÉ »ôi un col»õ de re√ÆncƒÉrcare.",
                    ideal: "Apartament modern √Æn centru sau l√¢ngƒÉ infrastructurƒÉ activƒÉ; plan deschis, luminƒÉ naturalƒÉ abundentƒÉ, solu»õii smart.",
                    checks: ["Acces rapid la cafenele, culturƒÉ, parcuri »ôi transport.", "Iluminat inteligent »ôi izolare acusticƒÉ decentƒÉ.", "Spa»õii flexibile pentru socializare »ôi retragere."],
                    tip: "Alege un ‚Äûhub personal‚Äù de unde po»õi porni spre ora»ô, dar unde te po»õi √Æntoarce pentru claritate »ôi energie.",
                },
                family: {
                    title: "Familist Structurat",
                    lead: "Pui pe primul loc securitatea, ordinea »ôi timpul √ÆmpreunƒÉ. Casa devine alinul comun al familiei.",
                    ideal: "CasƒÉ/ apartament mai generos √Æntr-un cartier lini»ôtit; acces pe jos la servicii; camere bine func»õionate.",
                    checks: ["G√¢nde»ôte pe 5+ ani (grƒÉdini»õƒÉ/»ôcoalƒÉ).", "VerificƒÉ vecinƒÉtatea »ôi comunitatea.", "Confort »ôi func»õionalitate √Ænainte de extra-design."],
                    tip: "FƒÉ-»õi o ‚ÄûhartƒÉ a rutinei‚Äù zilnice ‚Äì spa»õii pentru joacƒÉ, lucru, relaxare ‚Äì fiecare √Æ»ôi gƒÉse»ôte locul.",
                },
                dreamer: {
                    title: "VisƒÉtor al Naturii",
                    lead: "Ai nevoie de lini»ôte, luminƒÉ »ôi texturi naturale. Ai nevoie de un spa»õiu care inspirƒÉ »ôi calmeazƒÉ.",
                    ideal: "Apartament cu vedere spre verde sau casƒÉ la marginea ora»ôului; materiale naturale, plante vii, ferestre mari.",
                    checks: ["EvitƒÉ interioare reci »ôi √ÆncƒÉrcate.", "CreeazƒÉ zone pentru retragere »ôi creativitate.", "ObservƒÉ cum spa»õiul √Æ»õi influen»õeazƒÉ starea."],
                    tip: "TransformƒÉ-»õi locuin»õa √Æntr-o sursƒÉ de energie bl√¢ndƒÉ: luminƒÉ, plante, textile moi, paletƒÉ pƒÉm√¢ntie.",
                },
                minimal: {
                    title: "Minimalist Con»ôtient",
                    lead: "Pre»õuie»ôti simplitatea, claritatea »ôi ordinea. Spa»õiul curat √Æ»õi sus»õine focusul.",
                    ideal: "Studio/ apartament cu plan clar; tonuri deschise; piese esen»õiale; eficien»õƒÉ la fiecare metru.",
                    checks: ["EvitƒÉ supra√ÆncƒÉrcarea ‚Äì pƒÉstreazƒÉ doar ce are sens.", "CautƒÉ ergonomii & flexibilitate √Æn mobilier.", "Maxim luminƒÉ & aer; mai pu»õin obiect, mai multƒÉ calitate."],
                    tip: "Casa ta e oglinda min»õii tale: ordine √Æn vedere, iar simplitatea √Æ»õi men»õine echilibrul lini»ôtit.",
                },
                introvert: {
                    title: "Introvert Reflexiv",
                    lead: "Apreciezi lini»ôtea, intimitatea »ôi controlul asupra timpului tƒÉu. Zgomotul te obose»ôte.",
                    ideal: "Locuin»õƒÉ retrasƒÉ sau bine izolatƒÉ fonic; birou/col»õ personal; control al luminii »ôi al expunerii.",
                    checks: ["UitƒÉ-te la scoruri de zgomot & ferestre de calitate.", "Alege cartiere cu densitate mai scƒÉzutƒÉ.", "CreeazƒÉ un ritual de searƒÉ: loc fix pentru reflec»õie."],
                    tip: "Alege un stil √Æn care po»õi sƒÉ te √Æntorci la tine: lini»ôtea √Æ»õi amplificƒÉ poten»õialul.",
                },
                visionary: {
                    title: "Vizionari Strategici",
                    lead: "E»ôti orientat pe obiective »ôi idei. Ai nevoie de spa»õiu care te concentreazƒÉ »ôi te proiecteazƒÉ spre urmƒÉtorul nivel.",
                    ideal: "Loft/ apartament cu vedere amplƒÉ; birou dedicat; zone pentru concentrare »ôi vizualizare.",
                    checks: ["PrioritizeazƒÉ un ancoraj vizual pentru »õinte.", "Separare clarƒÉ √Æntre lucru »ôi relaxare.", "Tehnologii care reduc fric»õiunea."],
                    tip: "LasƒÉ-»õi casa sƒÉ-»õi fie platformƒÉ de lansare: creeazƒÉ un ‚Äûcol»õ de sprint‚Äù care √Æ»õi calibreazƒÉ ambi»õia.",
                },
                builder: {
                    title: "Creator Pragmatic",
                    lead: "Om de ac»õiune: practicul »ôi finalul primeazƒÉ. Func»õionalitatea √Æ»õi economise»ôte timp »ôi energie.",
                    ideal: "Apartament cu plan logic, trasee scurte; materiale robuste »ôi u»ôor de √Æntre»õinut.",
                    checks: ["Zonare strict pe func»õiuni (lucru, depozitare, odihnƒÉ).", "Componente rezistente, √Æntre»õinere simplƒÉ.", "PrioritizeazƒÉ solu»õii care cresc randamentul zilnic."],
                    tip: "G√¢nde»ôte locuin»õa ca pe un instrument: fiecare element trebuie sƒÉ munceascƒÉ pentru eficien»õa ta.",
                },
            };

            /** 4) Render + afi»ôare formular email la nevoie **/
            function render(profileKey) {
                const data = profileData[profileKey];
                const badge = document.getElementById("badge");
                const card = document.getElementById("card");

                if (!data) {
                    document.getElementById("fallback").style.display = "block";
                    return;
                }

                document.getElementById("emoji").textContent = (emojis[profileKey] || "üè†") + " ";
                document.getElementById("badgeTitle").textContent = data.title;
                document.getElementById("head").textContent = data.lead;
                document.getElementById("ideal").textContent = data.ideal;

                const ul = document.getElementById("checks");
                ul.innerHTML = "";
                data.checks.forEach((c) => {
                    const li = document.createElement("li");
                    li.textContent = c;
                    ul.appendChild(li);
                });

                document.getElementById("tip").textContent = data.tip;

                badge.style.display = "inline-flex";
                card.style.display = "block";

                // dacƒÉ venim din checkout (ai buton View result), afi»ôeazƒÉ formularul
                const fromCheckout = qs.get("from") === "checkout" || !qs.get("direct");
                if (fromCheckout) document.getElementById("emailBlock").style.display = "block";
            }

            /** 5) ValideazƒÉ profil & porne»ôte **/
            const allowed = Object.keys(profileData);
            if (!allowed.includes(profile)) {
                // dacƒÉ nu primim profil corect, nu for»õƒÉm nimic
                document.getElementById("fallback").style.display = "block";
            } else {
                render(profile);
            }

            /** 6) Trimitere la Make **/
            const WEBHOOK_URL = "https://PUTE»öI_PUNE_AICI_URLUL_TƒÇU_DE_WEBHOOK"; // <-- schimbƒÉ!

            (function initEmailSend() {
                const form = document.getElementById("sendForm");
                if (!form) return;
                const msg = document.getElementById("msg");
                const btn = document.getElementById("sendBtn");

                form.addEventListener("submit", async (e) => {
                    e.preventDefault();
                    const email = (document.getElementById("email").value || "").trim();
                    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                        msg.style.display = "block";
                        msg.textContent = "AdresƒÉ email invalidƒÉ.";
                        return;
                    }

                    btn.disabled = true;
                    msg.style.display = "block";
                    msg.textContent = "Se trimite‚Ä¶";

                    try {
                        const res = await fetch(WEBHOOK_URL, {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ email, profile, lang, session_id: session, order_id: orderId }),
                        });
                        msg.textContent = res.ok ? "Trimis! VerificƒÉ inbox-ul (»ôi spam)." : "Eroare la trimitere. √éncearcƒÉ din nou.";
                    } catch (_) {
                        msg.textContent = "Re»õea indisponibilƒÉ. √éncearcƒÉ din nou.";
                    } finally {
                        btn.disabled = false;
                    }
                });
            })();
        </script>
    </body>
</html>
